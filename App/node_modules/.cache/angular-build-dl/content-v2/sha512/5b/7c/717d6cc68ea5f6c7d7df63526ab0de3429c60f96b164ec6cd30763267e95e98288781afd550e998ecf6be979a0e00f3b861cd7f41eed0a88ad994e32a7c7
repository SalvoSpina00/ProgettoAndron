(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["pages-edit-profile-edit-profile-module"],{

/***/ "02SC":
/*!*******************************************************************!*\
  !*** ./src/app/pages/edit-profile/edit-profile-routing.module.ts ***!
  \*******************************************************************/
/*! exports provided: EditProfilePageRoutingModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditProfilePageRoutingModule", function() { return EditProfilePageRoutingModule; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "fXoL");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ "tyNb");
/* harmony import */ var _edit_profile_page__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./edit-profile.page */ "kmVb");




const routes = [
    {
        path: '',
        component: _edit_profile_page__WEBPACK_IMPORTED_MODULE_3__["EditProfilePage"]
    }
];
let EditProfilePageRoutingModule = class EditProfilePageRoutingModule {
};
EditProfilePageRoutingModule = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({
        imports: [_angular_router__WEBPACK_IMPORTED_MODULE_2__["RouterModule"].forChild(routes)],
        exports: [_angular_router__WEBPACK_IMPORTED_MODULE_2__["RouterModule"]],
    })
], EditProfilePageRoutingModule);



/***/ }),

/***/ "S5E+":
/*!*************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/pages/edit-profile/edit-profile.page.html ***!
  \*************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<ion-header>\n  <ion-toolbar>\n    <ion-title>Modifica Profilo</ion-title>\n    <ion-buttons slot=\"start\">\n      <ion-menu-button autoHide=\"false\"></ion-menu-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content id=\"myContent\">\n  <ion-list>\n    <ion-title class=\"ion-text-center\"></ion-title>\n        \n      <ion-img src=\"{{ imgSrc }}\"></ion-img>\n      <ion-button *ngIf=\"mobile\" id=\"myButtonYellow\" expand=\"full\" (click)=\"chooseImage()\">Cambia foto</ion-button>\n      \n      <ion-button *ngIf=\"!mobile\" id=\"myButtonYellow\" expand=\"full\" (click)=\"f.click()\">Cambia foto</ion-button>\n      <input  class=\"ion-hide\" #f type=\"file\" (change)=\"chooseImage($event)\" id=\"file-input\" accept=\"image/png, image/jpeg\">\n\n      <div *ngIf=\"this.utenza=='utente'\">\n      <ion-item>\n        <ion-input placeholder=\"Telefono\"  maxlength=\"20\"[(ngModel)]=\"telefono\"></ion-input>\n        </ion-item>\n      <ion-item>\n        <ion-input placeholder=\"Mail\"   maxlength=\"30\"[(ngModel)]=\"mail\"></ion-input>\n      </ion-item>\n      <ion-item>\n          <ion-input placeholder=\"Stato\"   maxlength=\"20\"[(ngModel)]=\"stato\"></ion-input>\n        </ion-item>\n        <ion-item>\n            <ion-input placeholder=\"Regione\"  maxlength=\"20\"[(ngModel)]=\"regione\"></ion-input>\n          </ion-item>\n      <ion-item>\n        <ion-input placeholder=\"Città\"  maxlength=\"30\"[(ngModel)]=\"citta\"></ion-input>\n      </ion-item>\n      <ion-item>\n        <ion-input placeholder=\"Via\"  maxlength=\"30\" [(ngModel)]=\"via\"></ion-input>\n      </ion-item>\n      <ion-item>\n        <ion-input placeholder=\"Cap\" maxlength=\"10\" [(ngModel)]=\"cap\"></ion-input>\n      </ion-item>\n    </div>\n  </ion-list>\n  <p>{{ this.errore }}</p>\n  <ion-button id=\"myButtonYellow\" expand=\"full\" (click) = \"editProfile()\" *ngIf=\"this.utenza=='utente'\">Modifica</ion-button>\n  <p>{{this.errorep}}</p>\n    <ion-button id=\"myButtonYellow\" expand=\"full\" (click)=\"cambiaPass()\">Cambia Password</ion-button>\n\n</ion-content>\n");

/***/ }),

/***/ "k578":
/*!***********************************************************!*\
  !*** ./src/app/pages/edit-profile/edit-profile.module.ts ***!
  \***********************************************************/
/*! exports provided: EditProfilePageModule */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditProfilePageModule", function() { return EditProfilePageModule; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "fXoL");
/* harmony import */ var _angular_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/common */ "ofXK");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/forms */ "3Pt+");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic/angular */ "c7TG");
/* harmony import */ var _edit_profile_routing_module__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./edit-profile-routing.module */ "02SC");
/* harmony import */ var _edit_profile_page__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./edit-profile.page */ "kmVb");







let EditProfilePageModule = class EditProfilePageModule {
};
EditProfilePageModule = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({
        imports: [
            _angular_common__WEBPACK_IMPORTED_MODULE_2__["CommonModule"],
            _angular_forms__WEBPACK_IMPORTED_MODULE_3__["FormsModule"],
            _ionic_angular__WEBPACK_IMPORTED_MODULE_4__["IonicModule"],
            _edit_profile_routing_module__WEBPACK_IMPORTED_MODULE_5__["EditProfilePageRoutingModule"]
        ],
        declarations: [_edit_profile_page__WEBPACK_IMPORTED_MODULE_6__["EditProfilePage"]]
    })
], EditProfilePageModule);



/***/ }),

/***/ "kmVb":
/*!*********************************************************!*\
  !*** ./src/app/pages/edit-profile/edit-profile.page.ts ***!
  \*********************************************************/
/*! exports provided: EditProfilePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditProfilePage", function() { return EditProfilePage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "mrSG");
/* harmony import */ var _raw_loader_edit_profile_page_html__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! raw-loader!./edit-profile.page.html */ "S5E+");
/* harmony import */ var _edit_profile_page_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./edit-profile.page.scss */ "tGd5");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/core */ "fXoL");
/* harmony import */ var src_app_services_api_service_service__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! src/app/services/api-service.service */ "ul72");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @ionic/angular */ "c7TG");
/* harmony import */ var _ionic_storage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ionic/storage */ "e8h1");
/* harmony import */ var src_app_app_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! src/app/app.component */ "Sy1n");








let EditProfilePage = class EditProfilePage {
    constructor(apiService, storage, alertController, app) {
        this.apiService = apiService;
        this.storage = storage;
        this.alertController = alertController;
        this.app = app;
        this.mobile = !(this.apiService.getPlatform().includes("mobileweb") || this.apiService.getPlatform().includes("desktop"));
        storage.get('anagraficaJson').then((val) => {
            if (val["foto"] == null) {
                this.imgSrc = this.apiService.user;
            }
            else {
                this.imgSrc = 'data:image/jpeg;base64,' + val["foto"];
            }
            this.telefono = val["tel"];
            this.mail = val["email"];
            this.stato = val["stato"];
            this.regione = val["regione"];
            this.citta = val["citta"];
            this.via = val["via"];
            this.cap = val["cap"];
        });
        this.utenza = this.app.utenza;
        this.errore = '';
        this.errorep = '';
    }
    ngOnInit() { }
    checkInput() {
        var _a, _b, _c, _d, _e, _f, _g;
        this.telefono = (_a = this.telefono) !== null && _a !== void 0 ? _a : "";
        this.mail = (_b = this.mail) !== null && _b !== void 0 ? _b : "";
        this.stato = (_c = this.stato) !== null && _c !== void 0 ? _c : "";
        this.regione = (_d = this.regione) !== null && _d !== void 0 ? _d : "";
        this.citta = (_e = this.citta) !== null && _e !== void 0 ? _e : "";
        this.via = (_f = this.via) !== null && _f !== void 0 ? _f : "";
        this.cap = (_g = this.cap) !== null && _g !== void 0 ? _g : "";
        if (this.telefono.trim() === "" || this.mail.trim() === "" || this.stato.trim() === "" || this.regione.trim() === "" || this.citta.trim() === "" || this.via.trim() === "" || this.cap.trim() === "") {
            return false;
        }
        return true;
    }
    editProfile() {
        if (!this.checkInput()) {
            this.errore = "Compila adeguatamente tutti i campi";
        }
        this.apiService.updateUtente(this.telefono, this.mail, this.stato, this.regione, this.citta, this.cap, this.via).then(retApiService => {
            retApiService.subscribe({
                next: () => {
                    this.apiService.simplyAlert(() => {
                        this.apiService.getAnagrafica().then(retApiService => {
                            retApiService.subscribe({
                                next: (response) => {
                                    this.storage.set("anagraficaJson", response);
                                },
                                error: () => {
                                    this.apiService.simplyAlert();
                                }
                            });
                        });
                    }, "Operazione effettuata", "Le modifiche sono state apportate");
                },
                error: () => {
                    this.apiService.simplyAlert();
                }
            });
        });
    }
    cambiaPass() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const alert = yield this.alertController.create({
                header: "Attenzione",
                message: "Inserire nuova password e la conferma della password(min 8 caratteri e almeno 1 Maiuscola)",
                inputs: [
                    {
                        name: 'vecchiapassword',
                        type: 'password',
                        placeholder: 'Vecchia password'
                    },
                    {
                        name: 'password',
                        type: 'password',
                        placeholder: 'Nuova password'
                    },
                    {
                        name: 'check',
                        type: 'password',
                        placeholder: 'Conferma password'
                    }
                ],
                buttons: [
                    {
                        text: 'Annulla',
                        role: 'cancel',
                    },
                    {
                        text: 'Ok',
                        handler: data => {
                            if (!(data.password && data.check)) {
                                this.errorep = "Compila tutti i campi";
                                return;
                            }
                            if (data.password.trim() == '' || data.check.trim() == '') {
                                this.errorep = "Password non valida";
                                return;
                            }
                            if (data.password != data.check) {
                                this.errorep = "Le password non coincidono";
                                return;
                            }
                            this.apiService.updatePassword(data.vecchiapassword, data.password).then(retApiService => {
                                retApiService.subscribe({
                                    next: () => {
                                        this.apiService.simplyAlert(() => { }, "Operazione effettuata", "Il cambio password è stato effettuato correttamente");
                                    },
                                    error: (errore) => {
                                        if (errore.status == 401) {
                                            this.errorep = "La vecchia password non è corretta";
                                        }
                                        else {
                                            this.apiService.simplyAlert();
                                        }
                                    }
                                });
                            });
                        }
                    }
                ]
            });
            yield alert.present();
        });
    }
    chooseImage($event = null) {
        let img = this.imgSrc;
        let handler = (imgPath) => {
            this.imgSrc = 'data:image/jpeg;base64,' + imgPath;
            this.foto = imgPath;
            this.apiService.confirmAlert(() => {
                this.apiService.updateProfilePic(this.foto).then(resp => {
                    resp.subscribe({
                        next: (response) => {
                            this.storage.set("anagraficaJson", response);
                        },
                        error: () => {
                            this.apiService.simplyAlert();
                        }
                    });
                });
            }, "Attenzione", "Vuoi usare l'immagine selezionata come foto per il profilo?", () => {
                this.imgSrc = img;
            });
        };
        if (this.mobile) {
            this.apiService.chooseImage(handler);
        }
        else {
            this.apiService.getImageBrowser($event, handler);
        }
    }
};
EditProfilePage.ctorParameters = () => [
    { type: src_app_services_api_service_service__WEBPACK_IMPORTED_MODULE_4__["ApiService"] },
    { type: _ionic_storage__WEBPACK_IMPORTED_MODULE_6__["Storage"] },
    { type: _ionic_angular__WEBPACK_IMPORTED_MODULE_5__["AlertController"] },
    { type: src_app_app_component__WEBPACK_IMPORTED_MODULE_7__["AppComponent"] }
];
EditProfilePage = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_3__["Component"])({
        selector: 'app-edit-profile',
        template: _raw_loader_edit_profile_page_html__WEBPACK_IMPORTED_MODULE_1__["default"],
        styles: [_edit_profile_page_scss__WEBPACK_IMPORTED_MODULE_2__["default"]]
    }),
    Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"])("design:paramtypes", [src_app_services_api_service_service__WEBPACK_IMPORTED_MODULE_4__["ApiService"], _ionic_storage__WEBPACK_IMPORTED_MODULE_6__["Storage"], _ionic_angular__WEBPACK_IMPORTED_MODULE_5__["AlertController"], src_app_app_component__WEBPACK_IMPORTED_MODULE_7__["AppComponent"]])
], EditProfilePage);



/***/ }),

/***/ "tGd5":
/*!***********************************************************!*\
  !*** ./src/app/pages/edit-profile/edit-profile.page.scss ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("p {\n  color: red;\n  text-align: center;\n}\n\nion-item {\n  color: #457c8d;\n  --highlight-color-invalid: red;\n  --highlight-color-valid: rgb(0, 255, 115);\n}\n\nion-item:hover {\n  background-color: #404f79;\n}\n\nion-img {\n  height: 25vh;\n  width: auto;\n  margin: auto;\n  display: block;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2VkaXQtcHJvZmlsZS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxVQUFBO0VBQ0Esa0JBQUE7QUFDSjs7QUFDQTtFQUNJLGNBQUE7RUFFQSw4QkFBQTtFQUNBLHlDQUFBO0FBQ0o7O0FBRUE7RUFDSSx5QkFBQTtBQUNKOztBQUVBO0VBQ0ksWUFBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtBQUNKIiwiZmlsZSI6ImVkaXQtcHJvZmlsZS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJwIHtcbiAgICBjb2xvcjogcmVkO1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cbmlvbi1pdGVtIHtcbiAgICBjb2xvcjogIzQ1N2M4ZDs7XG4vLyAgICAtLWJvcmRlci1jb2xvcjogd2hpdGU7IC8vIGRlZmF1bHQgdW5kZXJsaW5lIGNvbG9yXG4gICAgLS1oaWdobGlnaHQtY29sb3ItaW52YWxpZDogcmVkOyAvLyBpbnZhbGlkIHVuZGVybGluZSBjb2xvclxuICAgIC0taGlnaGxpZ2h0LWNvbG9yLXZhbGlkOiByZ2IoMCwgMjU1LCAxMTUpOyAvLyB2YWxpZCB1bmRlcmxpbmUgY29sb3Jcbn1cblxuaW9uLWl0ZW06aG92ZXJ7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzQwNGY3OTtcbn1cblxuaW9uLWltZ3tcbiAgICBoZWlnaHQ6IDI1dmg7XG4gICAgd2lkdGg6IGF1dG87XG4gICAgbWFyZ2luOiBhdXRvO1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIFxufSJdfQ== */");

/***/ })

}]);
//# sourceMappingURL=pages-edit-profile-edit-profile-module-es2015.js.map